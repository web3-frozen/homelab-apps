# AlertManagerConfig â€” routes onchain-monitor alerts to Telegram
---
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: onchain-monitor-telegram
  namespace: monitoring
spec:
  route:
    receiver: telegram-infra
    groupBy: ["alertname", "source"]
    groupWait: 30s
    groupInterval: 5m
    repeatInterval: 4h
    matchers:
      - name: namespace
        value: onchain-monitor
        matchType: "="
  receivers:
    - name: telegram-infra
      telegramConfigs:
        - chatID: 338591783
          botToken:
            name: alertmanager-telegram
            key: token
          message: |
            ðŸ”” <b>{{ .Status | toUpper }}</b> {{ if eq .Status "firing" }}ðŸ”¥{{ else }}âœ…{{ end }}

            {{ range .Alerts }}
            <b>{{ .Labels.alertname }}</b> ({{ .Labels.severity }})
            {{ .Annotations.summary }}
            {{ .Annotations.description }}
            {{ end }}
          parseMode: HTML
